(window.webpackJsonp=window.webpackJsonp||[]).push([[144],{1238:function(t,e,i){"use strict";i.r(e);i(22);var a={name:"excelUpload",data:function(){return{active:0,stepData:[{id:1,title:"上传文件",slotName:"first",btnArr:[{btnTitle:"下一步",fn:this.next}]},{id:2,title:"核对信息",slotName:"second",btnArr:[{btnTitle:"上一步",fn:this.stepBack},{btnTitle:"下一步",fn:this.submitBtn}]},{id:3,title:"完成"}],lastBtnTitle:"完成",successTitle:"发票导入完成...",fileName:"",importRecNum:0,tableData:[],tableHeader:[]}},created:function(){},methods:{beforeUpload:function(t){return this.fileName=t.name,t.size/1024/1024<1||(this.$message({message:"请不要上传大于1m的文件.",type:"warning"}),!1)},handleSuccess:function(t){var e=t.results,i=t.header;this.importRecNum=e.length,this.tableData=e,this.tableHeader=i},submitBtn:function(t){this.active+=2,this.fileName=""},next:function(){if(!this.fileName)return this.$message({message:"请先上传文件.",type:"warning"}),!1;this.active+=1},stepBack:function(){this.active-=1},complete:function(){this.active=0},downloadTemplate:function(){console.log("下载模板")}}},n=i(10),s=Object(n.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"excel-upload",staticStyle:{width:"100%"}},[i("p-layout",{attrs:{sectionTitle:"Excel上传组件"}},[i("p-step-wizard",{staticStyle:{"min-height":"400px"},attrs:{stepData:t.stepData,lastBtnTitle:t.lastBtnTitle,active:t.active,successTitle:t.successTitle},on:{complete:t.complete},scopedSlots:t._u([{key:"first",fn:function(){return[i("div",{staticClass:"content-main"},[i("p-upload-excel",{attrs:{"on-success":t.handleSuccess,"before-upload":t.beforeUpload,selectedFileText:t.fileName}}),t._v(" "),i("div",{staticClass:"hint p-margin-top-10"},[i("i",{staticClass:"i-icon icon iconfont icon-prompt p-padding5 text-primary"}),t._v(" \n            "),i("b",[t._v("提示：")]),t._v(" "),i("span",{staticClass:"text-muted"},[t._v("\n              1、如果您还没有导入模板，请点击\n              "),i("a",{on:{click:t.downloadTemplate}},[t._v("发票导入模板下载.xlsx")])]),t._v(" "),i("br"),t._v(" "),i("span",{staticClass:"text-muted",staticStyle:{"margin-left":"76px"}},[t._v("2、相同的发票不能重复上传，若已上传的数据不正确，请先删除，再重新上传。(发票号码和发票代码相同的为同一张发票)")])])],1)]},proxy:!0},{key:"second",fn:function(){return[i("div",{staticClass:"content-main"},[i("div",{staticClass:"alert-content"},[i("div",{staticClass:"alert alert-info text-center"},[i("i",{staticClass:"i-icon icon iconfont icon-prompt p-padding5 text-primary"}),t._v(" \n              "),i("span",[t._v("\n                您本次共导入\n                "),i("span",{staticClass:"text-danger"},[t._v(t._s(t.importRecNum))]),t._v("条记录\n              ")])])]),t._v(" "),i("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,border:"","highlight-current-row":""}},t._l(t.tableHeader,(function(t){return i("el-table-column",{key:t,attrs:{prop:t,label:t,"show-overflow-tooltip":"","min-width":"220",align:"center"}})})),1)],1)]},proxy:!0}])})],1)],1)}),[],!1,null,null,null);e.default=s.exports}}]);